version: 2
jobs:
  dokka:
    docker:
    - image: ubuntu:14.04
    working_directory: ~/arrow
    steps:
    - run:
        name: Run dokka
        command: ./gradlew dokka
  ank:
    docker:
    - image: ubuntu:14.04
    working_directory: ~/arrow
    steps:
    - run:
        name: Run Ank if dokka pass and branch is not Master
        command: ./gradlew :arrow-docs:runAnk
  ank-master:
    docker:
    - image: ubuntu:14.04
    working_directory: ~/arrow
    steps:
    - run:
        name: Run Ank if dokka pass and branch is Master
        command: ./gradlew :arrow-docs:runAnk

workflows:
  version: 2
  build-deploy:
    jobs:
    - ank:
        requires:
        - dokka
        filters:
          branches:
            ignore: master
    - ank-master:
        requires:
        - dokka
        filters:
          branches:
            only: master